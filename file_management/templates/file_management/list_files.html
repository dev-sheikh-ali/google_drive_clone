<div class="row mt-5">
    <h4>Files in 
        {% if parent_folder %}
            {{ parent_folder.name }}
        {% else %}
            Root
        {% endif %}
    </h4>
    <div class="d-flex flex-wrap file-list-container">
        {% for file in files %}
        <div class="file-card text-center me-3 mb-3">
            <a href="{{ file.file.url }}" target="_blank">
                {% if file.extension == '.png' or file.extension == '.jpg' or file.extension == '.jpeg' %}
                    <i class="fas fa-file-image file-icon"></i>
                {% elif file.extension == '.pdf' %}
                    <i class="fas fa-file-pdf file-icon"></i>
                {% elif file.extension == '.doc' or file.extension == '.docx' %}
                    <i class="fas fa-file-word file-icon"></i>
                {% elif file.extension == '.txt' %}
                    <i class="fas fa-file-alt file-icon"></i>
                {% else %}
                    <i class="fas fa-file file-icon"></i>
                {% endif %}
                <h5 class="card-title">{{ file.name }}</h5>
            </a>
            <p>Size: {{ file.size }} bytes</p>
            <p>Last modified: {{ file.updated_at }}</p>
        </div>
        {% empty %}
        <p>No files available in this folder.</p>
        {% endfor %}
    </div>
</div>

<script>
    $(document).ready(function () {
        function reloadFiles() {
            const parent_id = "{{ parent_folder.id|default:0 }}";
            if (parent_id) {
                $.ajax({
                    url: "{% url 'list_files' parent_id=0 %}".replace("0", parent_id),
                    success: function (data) {
                        $('.file-list-container').html(data);
                    },
                    error: function () {
                        alert("Failed to load files.");
                    }
                });
            }
        }
    });
</script>
